Практическое задание курса спарк


1. Используя шаблон-генератор случайных данных написать приложение,
которое должно принимать на вход параметры:
--event-date=2023-10-01  # партиция с датой, за которую генерируются данные
--target-path=/data/generated_csv  # путь, куда складываются сгенерированные данные
--sample_count=10000  # число сгенерированных строк

Формат выходных данных: csv с колонками 

msisdn BIGINT  # номер абонента 
region  STRING  # регион подключения 
call_length_sec  INT # длительность подключения 1-600

поле region принимает значения 'MSK', 'SPB', 'OTHER' и должно быть закреплено за абонентом
генерацию этого поля нужно реализовать с помощью udf, которое будет сопоставлять 
каждому номеру свой регион, причем соотношение абонентов по регионам должно быть
MSK=30%, SPB=20%, OTHER=50%


2. На основе класса CsvToParquetPartitioned написать приложение, которое преобразует 
данные формата csv в формат parquet.
Параметры прииложения
   --event-date=2023-10-01 
   --target-path=/data/generated_parquet

3. На основе класса AggregatesPostgres написать приложение, которое будет считать
среднюю длительность подключения для каждого региона и сохранять результат в таблицу
postgre формата
event_date STRING
region STRING
call_length_sec_avg  INT

Параметры приложения
--event-date=2023-10-01
--target-table=avg_call_length_by_region

